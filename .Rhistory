ggplot(VCOSS_ACNC_Datasets_Combined,
aes(x = Year, fill = fct_rev(VCOSS_charitysize))) +
geom_line(position = "stack",
stat = "count") +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_fill_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
summarise(group_by(VCOSS_ACNC_Datasets_Combined.
main_activity, VCOSS_charitysize, Year),
count = n())
summarise(group_by(VCOSS_ACNC_Datasets_Combined,
main_activity, VCOSS_charitysize, Year),
count = n())
summarise(group_by(VCOSS_ACNC_Datasets_Combined,
VCOSS_charitysize, Year),
count = n())
vcoss_charitysize_year <- summarise(group_by(VCOSS_ACNC_Datasets_Combined,
VCOSS_charitysize, Year),
count = n())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
fill = fct_rev(VCOSS_charitysize))) +
geom_line(position = "identity") +
geom_point() +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_fill_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
color = fct_rev(VCOSS_charitysize))) +
geom_line(position = "identity") +
geom_point() +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = fct_rev(VCOSS_charitysize),
group = VCOSS_charitysize)) +
geom_line(position = "identity") +
geom_point() +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = fct_rev(VCOSS_charitysize),
group = VCOSS_charitysize)) +
geom_line(position = "identity",
size = 7/8) +
geom_point(size = 14/8) +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(VCOSS_ACNC_Datasets_Combined,
aes(x = Year, fill = fct_rev(VCOSS_charitysize))) +
geom_bar(position = "stack") +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_fill_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = fct_rev(VCOSS_charitysize),
group = VCOSS_charitysize)) +
geom_line(position = "identity",
size = 7/8) +
geom_point(size = 14/8) +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = fct_rev(VCOSS_charitysize),
group = fct_rev(VCOSS_charitysize))) +
geom_line(position = "identity",
size = 7/8) +
geom_point(size = 14/8) +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = VCOSS_charitysize,
group = VCOSS_charitysize)) +
geom_line(position = "identity",
size = 7/8) +
geom_point(size = 14/8) +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(totgrosinc_mainact_year,
aes(x = str_wrap(main_activity, 18), y = total_gross_income,
fill = Year)) +
geom_bar(stat = "identity",
position = "dodge") +
scale_x_discrete("Main Activity") +
scale_y_continuous("Total Gross Income",
labels = dollar_format(scale = 1/1000000000,
accuracy = 0.1,
suffix = "bn"),
expand = c(0.025, 0.05)) +
scale_fill_manual(values = rev(VCOSS_colours)) +
ggtitle("Victorian community services industry total gross income 2014 - 2018",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 55,
hjust = 1),
panel.grid.major.x = element_blank(),
axis.ticks.x = element_line(colour = "grey50"))
ggsave(filename = "totalgrossincome_by_mainactivity_year.png",
dpi = 600,
width = 75, height = 75,
units = "55")
ggsave(filename = "totalgrossincome_by_mainactivity_year.png",
dpi = 600,
width = 75, height = 75,
units = "mm")
ggsave(filename = "totalgrossincome_by_mainactivity_year.png",
dpi = 900,
width = 75, height = 75,
units = "mm")
ggsave(filename = "totalgrossincome_by_mainactivity_year.png",
dpi = 900,
width = 75, height = 75,
units = "cm")
ggsave(filename = "totalgrossincome_by_mainactivity_year.png",
dpi = 600)
ggsave(filename = "totalgrossincome_by_mainactivity_year.png",
dpi = 750)
ggplot(beneficiaries_mainact_year,
aes(x = `Number of Charities`, fill = Year,
y = fct_rev(str_wrap(main_beneficiaries, 30)))) +
geom_bar(stat = "identity",
position = "dodge") +
scale_x_continuous("Number of Charities",
labels = comma,
expand = c(0.005, 0.05)) +
scale_y_discrete("Main Activity") +
scale_fill_manual(values = VCOSS_colours) +
ggtitle("Beneficiaries of Victorian community services industry 2017 - 2018",
subtitle = "Number of charities servicing beneficiaries as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.y = element_blank(),
axis.ticks.y = element_line(colour = "grey50"))
ggsave(filename = "charitycount_by_beneficiaries.png",
dpi = 750)
ggsave(filename = "Visualisations/charitycount_by_beneficiaries.png",
dpi = 750)
ggplot(budgetstatus_mainact_year,
aes(x = Year, y = `Number of Charities`,
fill = `Budget status`, group = `Budget status`)) +
geom_area(stat = "identity")  +
facet_rep_wrap(~str_wrap(main_activity, 20),
scales = "free_y",
repeat.tick.labels = "x",
ncol = 3) +
scale_fill_manual(values = VCOSS_colours) +
ggtitle("Victorian community service industry budget status",
subtitle = "Main activity as reported in AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 55, hjust = 1))
ggplot(group_by(mainact_year, main_activity),
aes(x = Year, y = count,
group = main_activity,
colour = main_activity)) +
geom_line(colour = VCOSS_colours[1],
size = 7/8) +
geom_point(colour = VCOSS_colours[1],
size = 14/8) +
facet_rep_wrap(~str_wrap(main_activity, 28),
scales = "free_y",
repeat.tick.labels = "x",
ncol = 3) +
scale_y_continuous("Number of Charities",
breaks = breaks_extended(3)) +
ggtitle("Change in Victorian community service charities over time",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(mainact_year_donationsmade,
aes(x = str_wrap(main_activity, 20),
y = total_donations_made,
fill = Year)) +
geom_bar(stat = "identity",
position = "dodge") +
scale_y_continuous("Total donations made",
labels = dollar_format(scale = 0.000001,
suffix = "m"),
expand = c(0.0125, 0.025)) +
scale_x_discrete("Main activity") +
ggtitle("All donations made by Victorian community service charities",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 20, hjust = 1),
axis.ticks.x = element_line(colour = "grey"),
panel.grid.major.x = element_blank()) +
scale_fill_manual(values = rev(VCOSS_colours))
ggplot(VCOSS_ACNC_Datasets_Combined,
aes(x = Year, fill = fct_rev(VCOSS_charitysize))) +
geom_bar(position = "stack") +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_fill_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = VCOSS_charitysize,
group = VCOSS_charitysize)) +
geom_line(position = "identity",
size = 7/8) +
geom_point(size = 14/8) +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Visualisations.R', echo=TRUE)
ggsave(filename = "R_Visualisations/alldonationsmade_by_mainact_year.png",
dpi = 750,
height = 7.5, width = 10,
units = "in")
ggsave(filename = "R_Visualisations/alldonationsmade_by_mainact_year.png",
dpi = 750,
height = 21, width = 9,
units = "in")
ggplot(mainact_year_donationsmade,
aes(x = str_wrap(main_activity, 20),
y = total_donations_made,
fill = Year)) +
geom_bar(stat = "identity",
position = "dodge") +
scale_y_continuous("Total donations made",
labels = dollar_format(scale = 0.000001,
suffix = "m"),
expand = c(0.0125, 0.025)) +
scale_x_discrete("Main activity") +
ggtitle("All donations made by Victorian community service charities",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 20, hjust = 1),
axis.ticks.x = element_line(colour = "grey"),
panel.grid.major.x = element_blank()) +
scale_fill_manual(values = rev(VCOSS_colours))
ggsave(filename = "R_Visualisations/alldonationsmade_by_mainact_year.png",
dpi = 750,
height = 21, width = 9,
units = "in")
ggsave(filename = "R_Visualisations/alldonationsmade_by_mainact_year.png",
dpi = 750,
height = 9, width = 21,
units = "in")
gg_totgrosinc_mainact_year <- ggplot(totgrosinc_mainact_year,
aes(x = str_wrap(main_activity, 18), y = total_gross_income,
fill = Year)) +
geom_bar(stat = "identity",
position = "dodge") +
scale_x_discrete("Main Activity") +
scale_y_continuous("Total Gross Income",
labels = dollar_format(scale = 1/1000000000,
accuracy = 0.1,
suffix = "bn"),
expand = c(0.025, 0.05)) +
scale_fill_manual(values = rev(VCOSS_colours)) +
ggtitle("Victorian community services industry total gross income 2014 - 2018",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 55,
hjust = 1),
panel.grid.major.x = element_blank(),
axis.ticks.x = element_line(colour = "grey50"))
gg_totgrosinc_mainact_year
totgrosinc_mainact_year
gg_totgrosinc_mainact_year
ggplot(totgrosinc_mainact_year,
aes(x = str_wrap(main_activity, 18), y = total_gross_income,
fill = Year)) +
geom_bar(stat = "identity",
position = "dodge") +
scale_x_discrete("Main Activity") +
scale_y_continuous("Total Gross Income",
labels = dollar_format(scale = 1/1000000000,
accuracy = 0.1,
suffix = "bn"),
expand = c(0.025, 0.05)) +
scale_fill_manual(values = rev(VCOSS_colours)) +
ggtitle("Victorian community services industry total gross income 2014 - 2018",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 55,
hjust = 1),
panel.grid.major.x = element_blank(),
axis.ticks.x = element_line(colour = "grey50"))
gg_totgrosinc_mainact_year <- ggplot(totgrosinc_mainact_year,
aes(x = str_wrap(main_activity, 18), y = total_gross_income,
fill = Year)) +
geom_bar(stat = "identity",
position = "dodge") +
scale_x_discrete("Main Activity") +
scale_y_continuous("Total Gross Income",
labels = dollar_format(scale = 1/1000000000,
accuracy = 0.1,
suffix = "bn"),
expand = c(0.025, 0.05)) +
scale_fill_manual(values = rev(VCOSS_colours)) +
ggtitle("Victorian community services industry total gross income 2014 - 2018",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 55,
hjust = 1),
panel.grid.major.x = element_blank(),
axis.ticks.x = element_line(colour = "grey50"))
ggsave(filename = "R_Visualisations/totalgrossincome_by_mainactivity_year.png",
plot = gg_totgrosinc_mainact_year,
height = 8, width = 12,
units = "in", dpi = 750)
gg_beneficiaries_mainact_year <- ggplot(beneficiaries_mainact_year,
aes(x = `Number of Charities`, fill = Year,
y = fct_rev(str_wrap(main_beneficiaries, 30)))) +
geom_bar(stat = "identity",
position = "dodge") +
scale_x_continuous("Number of Charities",
labels = comma,
expand = c(0.005, 0.05)) +
scale_y_discrete("Main Activity") +
scale_fill_manual(values = VCOSS_colours) +
ggtitle("Beneficiaries of Victorian community services industry 2017 - 2018",
subtitle = "Number of charities servicing beneficiaries as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.y = element_blank(),
axis.ticks.y = element_line(colour = "grey50"))
ggsave(filename = "R_Visualisations/charitycount_by_beneficiaries.png",
plot = beneficiaries_mainact_year,
height = 12, width = 8,
units = "in", dpi = 750)
ggsave(filename = "R_Visualisations/charitycount_by_beneficiaries.png",
plot = gg_beneficiaries_mainact_year,
height = 12, width = 8,
units = "in", dpi = 750)
gg_budgetstatus_mainact_year <- ggplot(budgetstatus_mainact_year,
aes(x = Year, y = `Number of Charities`,
fill = `Budget status`, group = `Budget status`)) +
geom_area(stat = "identity")  +
facet_rep_wrap(~str_wrap(main_activity, 20),
scales = "free_y",
repeat.tick.labels = "x",
ncol = 3) +
scale_fill_manual(values = VCOSS_colours) +
ggtitle("Victorian community service industry budget status",
subtitle = "Main activity as reported in AIS") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 55, hjust = 1))
ggsave(filename = "R_Visualisations/budgetstatus_by_year_mainact.png",
plot = gg_budgetstatus_mainact_year,
height = 12, width = 8,
units = "in", dpi = 750)
gg_mainact_year <- ggplot(group_by(mainact_year, main_activity),
aes(x = Year, y = count,
group = main_activity,
colour = main_activity)) +
geom_line(colour = VCOSS_colours[1],
size = 7/8) +
geom_point(colour = VCOSS_colours[1],
size = 14/8) +
facet_rep_wrap(~str_wrap(main_activity, 28),
scales = "free_y",
repeat.tick.labels = "x",
ncol = 3) +
scale_y_continuous("Number of Charities",
breaks = breaks_extended(3)) +
ggtitle("Change in Victorian community service charities over time",
subtitle = "Main activity as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggsave(filename = "R_Visualisations/charitycount_by_mainact_year.png",
plot = gg_mainact_year,
height = 12, width = 8,
units = "in", dpi = 750)
gg_vcoss_charitysize_year <- ggplot(vcoss_charitysize_year,
aes(x = Year, y = count,
colour = VCOSS_charitysize,
group = VCOSS_charitysize)) +
geom_line(position = "identity",
size = 7/8) +
geom_point(size = 14/8) +
geom_text(stat = "count",
aes(label = ..count..,
y = ..count..),
colour = "white", position = "stack",
vjust = 1.25, check_overlap = TRUE) +
scale_colour_manual(values = c("cyan", VCOSS_colours),
"Charity Size") +
scale_y_continuous("Number of charities", labels = comma,
expand = c(0.0125, 0.025)) +
ggtitle("Changes in charity sizes throughout the years",
subtitle = "VCOSS-defined charity size using total gross income as reported in the AIS") +
theme_minimal() +
theme(panel.grid.major.x = element_blank())
ggsave(filename = "R_Visualisations/charitycount_by_VCOSScharitysize_year.png",
plot = gg_vcoss_charitysize_year,
height = 8, width = 12,
units = "in", dpi = 750)
source('B:/Analytics/VCOSS_ACNC_Report/Visualisations.R', echo=TRUE)
source('B:/Analytics/VCOSS_ACNC_Report/Visualisations.R', echo=TRUE)
