paste("\\b",
c("pty", "ltd", "inc"),
"\\b")
paste0("\\b",
c("pty", "ltd", "inc"),
"\\b")
str_detect(c("incorporated", "inc", "proprietary", "pty"), pattern = paste0("\\b",
c("pty", "ltd", "inc"),
"\\b"))
paste0("\\b",
c("pty", "ltd", "inc"),
"\\b") %>%
paste0()
paste0("\\b",
c("pty", "ltd", "inc")
"\\b",
collapse = "|")
paste0("\\b",
c("pty", "ltd", "inc"),
"\\b",
collapse = "|")
str_detect(c("incorporated", "inc", "proprietary", "pty"), pattern = paste0("\\b",
c("pty", "ltd", "inc"),
"\\b",
collapse = "|"))
str_detect(c("incorporated", "inc", "proprietary", "pty"),
pattern = paste0("\\b",
c("pty", "ltd", "inc"),
"\\b",
collapse = "|"))
str_detect(c("incorporated", "inc", "proprietary", "pty", "limited", "ltd"),
pattern = paste0("\\b",
c("pty", "ltd", "inc"),
"\\b",
collapse = "|"))
str_trim(str_remove_all(ACNC_charities,
regex(pattern = paste0("\\b",
c("pty", "ltd", "inc"),
"\\b",
collapse = "|"),
ignore_case = TRUE)))
source('~/.active-rstudio-document', echo=TRUE)
CharityName_matches[199]; CharityName_matches[640]
ACNC_charities[199]; ACNC_charities[640]
ACNC_charities[323]; ACNC_charities[322]
CharityName_matches <- which(CharityName_DistMat >= 1 &
CharityName_DistMat <= 2,
arr.ind = TRUE)
CharityName_matches <- mutate(as.data.frame(CharityName_matches),
identity = if_else(row == col,
true = TRUE, false = FALSE))
CharityName_matches <- filter(CharityName_matches,
identity == FALSE)
CharityName_matches
ACNC_charities[323]; ACNC_charities[199]
ACNC_charities[199]; ACNC_charities[323]
CharityName_matches <- which(CharityName_DistMat >= 0 &
CharityName_DistMat <= 2,
arr.ind = TRUE)
CharityName_matches <- mutate(as.data.frame(CharityName_matches),
identity = if_else(row == col,
true = TRUE, false = FALSE))
CharityName_matches <- filter(CharityName_matches,
identity == FALSE)
CharityName_matches
filter(ACNC_charities,)
ACNC_charities[which(str_detect(ACNC_charities, regex("mind", ignore_case = TRUE)))]
ACNC_charities[which(str_detect(ACNC_charities, regex("ACNC", ignore_case = TRUE)))]
ACNC_charities[which(str_detect(ACNC_charities, regex("GROUP", ignore_case = TRUE)))]
ACNC_charities[which(str_detect(ACNC_charities, regex("ACNC", ignore_case = TRUE)))]
VCOSS_cleaned_data$charity_name[which(str_detect(VCOSS_cleaned_data$charity_name,
regex("ACNC", ignore_case = TRUE)))]
VCOSS_cleaned_data$charity_name[which(str_detect(VCOSS_cleaned_data$charity_name,
regex("Mind", ignore_case = TRUE)))]
ACNC_charities[which(str_detect(ACNC_charities,
regex("Mind", ignore_case = TRUE)))]
VCOSS_cleaned_data[which(str_detect(VCOSS_cleaned_data$charity_name,
regex("Mind", ignore_case = TRUE)))]
VCOSS_cleaned_data[, which(str_detect(VCOSS_cleaned_data$charity_name,
regex("Mind", ignore_case = TRUE)))]
filter(VCOSS_cleaned_data,
str_detect(charity_name, regex("mind", ignore_case = TRUE)))
filter(VCOSS_cleaned_data,
str_detect(charity_name, regex("mind", ignore_case = TRUE))) %>% View("mind")
47739536 / sum(371, 322, 129, 130)
47739536+13874974
59304785+1068477
59304785+1068477+1058445
59304785+1068477+1058445+1232552
59304785 / 62664259
0 / 62664259
0 / 62664259 %>% is.finite()
is.finite(0 / 62664259)
59304785+1068477+1058445+1232552
62664259
59304785+1068477+1058445+1232552 == 62664259
scales::dollar(61431707)
54162724521+13874974
47739536+13874974
scales::dollar(47739536+13874974)
library(scales)
dollar(2928054)
2928054+866365
CommunitySector_activities
paste0(CommunitySector_activities,
collapse = "|")
str_detect("other education", regex(paste0(CommunitySector_activities,
collapse = "|"),
ignore_case = TRUE))
CharityName_matches
ACNC_charities[199]; ACNC_charities[323]
as.matrix(stringdistmatrix(ACNC_charities,
method = "lcs"))
source('~/.active-rstudio-document', echo=TRUE)
CharityName_matches
min(CharityName_DistMat)
CharityName_matches <- which(CharityName_DistMat >= 0 &
CharityName_DistMat <= 2,
arr.ind = TRUE)
CharityName_matches
source('~/.active-rstudio-document', echo=TRUE)
CharityName_matches
ACNC_charities[43]; ACNC_charities[117]
ACNC_charities[19]; ACNC_charities[340]
ACNC_charities[135]; ACNC_charities[340]
ACNC_charities[640]; ACNC_charities[323]
ACNC_charities[779]; ACNC_charities[322]
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[335]; ACNC_charities[1]
ACNC_charities[249]; ACNC_charities[1]
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[779]; ACNC_charities[732]
ACNC_charities[630]; ACNC_charities[33]
ACNC_charities[597]; ACNC_charities[36]
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[1120]; ACNC_charities[1062]
ACNC_charities[597]; ACNC_charities[655]
ACNC_charities[779]; ACNC_charities[732]
ACNC_charities[349]; ACNC_charities[340]
ACNC_charities[39]; ACNC_charities[44]
CharityName_DistMat[39, 44]
ACNC_charities[50]; ACNC_charities[112]
CharityName_DistMat[50, 112]
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[1120]; ACNC_charities[1062]
CharityName_DistMat[1120, 1062]
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[476]; ACNC_charities[477]
ACNC_charities[322]; ACNC_charities[323]
ACNC_charities[871]; ACNC_charities[734]
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[630]; ACNC_charities[33]
ACNC_charities[199]; ACNC_charities[323]
ACNC_charities[640]; ACNC_charities[597]
ACNC_charities[199]; ACNC_charities[640]
CharityName_DistMat[1120, 1062]
ACNC_charities[1120]; ACNC_charities[1062]
colnames(ACNC_Datasets_13to18$datadotgov_ais16)
sort(colnames(ACNC_Datasets_13to18$datadotgov_ais16))
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
VCOSS_ACNC_Datasets_14to18$datadotgov_ais16
VCOSS_cleaned_data[, which(VCOSS_cleaned_data$abn %in% VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn)]
VCOSS_cleaned_data[which(VCOSS_cleaned_data$abn %in% VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn)]
VCOSS_cleaned_data[which(VCOSS_cleaned_data$abn %in% VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn), ]
VCOSS_cleaned_data[which(!(VCOSS_cleaned_data$abn %in% VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn)), ]
VCOSS_cleaned_data[which(!(VCOSS_cleaned_data$abn %in% VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn)), ] %>%
View("Missing from processed data")
1231494+8613+1198
1231494+8613+1198+684763
2131494+8613+1198+684763
13456341+4627299
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
charity_name == "Australian Breastfeeding Association")
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
charity_name == "Australian Breastfeeding Association") %>% View
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
str_detect(charity_name, "Eli's Gift")) %>% View
duplicated(ACNC_Datasets_14to18$datadotgov_ais16)
ACNC_Datasets_14to18$datadotgov_ais16[which(duplicated(ACNC_Datasets_14to18$datadotgov_ais16))]
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
str_detect(charity_name, "Eli's Gift")) %>% distinct()
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
str_detect(charity_name, "Eli's Gift")) %>% distinct(select(., -charity_name))
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
1267835+15435+6065+1660173
2078368+23863+1452866
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,)
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
abn == "37972629513")
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
VCOSS_ACNC_Datasets_14to18$datadotgov_ais16[which(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn %in% VCOSS_cleaned_data$abn),]
VCOSS_ACNC_Datasets_14to18$datadotgov_ais16[which(!(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16$abn %in% VCOSS_cleaned_data$abn)),]
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
donations_and_bequests
3596463+1163433
3596463+1163433
4736692+29855
4736692+29855+2389720
matching_cols
CommunitySector_activities
str_detect("Aged Care Activities",
regex(paste0(CommunitySector_activities,
collapse = "|"),
ignore_case = TRUE))
1628616
dollar(1628616)
dollar(161810)
37025000+416000+16336000
36432000/45
dollar(36432000/45)
nrow(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
136287/13
145305+16505
136278+23083
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
str_detect("civic and advocacy activities",
regex(paste0(CommunitySector_activities,
collapse = "|"),
ignore_case = TRUE))
1342707/12
2749425
1342707+1009891
View(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16, "2016")
str_detect("VIC",
regex("vic|victoria",
ignore_case = TRUE))
dollar(2749425)
(0+0)/2749425
is.finite((0+0)/2749425)
1342707+1009891
abs(25-30)
25-30
(1342707+1009891)-2352598
(172182+282687)-454869
ACNC_charities
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities
CharityName_DistMat
CharityName_matches
ACNC_charities[1120]; ACNC_charities[1062]
ACNC_charities[1226]; ACNC_charities[4716]
source('~/.active-rstudio-document', echo=TRUE)
ACNC_charities[2031]; ACNC_charities[2016]
ACNC_charities[3161]; ACNC_charities[3058]
ACNC_charities[4268]; ACNC_charities[4046]
filter(VCOSS_cleaned_data,
str_detect(charity_name, regex("Australian Breastfeeding", ignore_case = TRUE))) %>% View("ABF")
year
rm(list=ls())
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
year
year <- "datadotgov_ais16.xlsx"
str_extract(year, "\\d\\d")
individual_year <- str_extract(year, "\\d\\d")
objects(ACNC_CombinedDatasets_15to17[[year]])
objects(ACNC_CombinedDatasets_15to17[year])
objects(ACNC_Datasets_13to18)
for(year in ACNC_CombinedDatasets_15to17) {
print(year)
}
individual_year
objects(ACNC_Datasets_13to18)[which(str_detect(objects(ACNC_Datasets_13to18),
individual_year))]
matching_year
individual_year
matching_year
matching_year <- objects(ACNC_Datasets_13to18)[which(str_detect(objects(ACNC_Datasets_13to18),
individual_year))]
matching_year
ACNC_Datasets_13to18[matching_year]
ACNC_CombinedDatasets_15to17[year]
ACNC_CombinedDatasets_15to17[[year]]
ACNC_CombinedDatasets_15to17
year
for(year in 1:length(ACNC_CombinedDatasets_15to17)) {
print(year)
}
objects(ACNC_CombinedDatasets_15to17[year])
individual_dfname <- objects(ACNC_CombinedDatasets_15to17[year])
individual_year <- str_extract(year, "\\d\\d")
objects(ACNC_Datasets_13to18)[which(str_detect(objects(ACNC_Datasets_13to18),
individual_year))]
individual_year
individual_dfname
str_extract(individual_dfname, "\\d\\d")
individual_year <- str_extract(individual_dfname, "\\d\\d")
objects(ACNC_Datasets_13to18)[which(str_detect(objects(ACNC_Datasets_13to18),
individual_year))]
matching_year <- objects(ACNC_Datasets_13to18)[which(str_detect(objects(ACNC_Datasets_13to18),
individual_year))]
ACNC_Datasets_13to18[matching_year]
ACNC_CombinedDatasets_15to17[[year]]
ACNC_CombinedDatasets_15to17[year]
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
filter(ACNC_Datasets_13to18$datadotgov_ais15.xlsx,
str_detect(abn, "91111")) %>% View
ACNC_CombinedDatasets_15to17$datadotgov_ais15.xlsx
ACNC_CombinedDatasets_15to17[year]
filter(ACNC_CombinedDatasets_15to17$datadotgov_ais17.xlsx,
str_detect(abn, "91111")) %>% View
ACNC_groupdata
View(ACNC_groupdata, "group")
colnames(ACNC_groupdata)
sort(colnames(ACNC_groupdata))
unique(ACNC_groupdata$charity_name)
filter(ACNC_CombinedDatasets_15to17$datadotgov_ais16.xlsx,
str_detect(abn, "91111")) %>% View
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
select(ACNC_groupdata,
any_of(colnames(ACNC_Datasets_13to18[[year]]),
"charity_name" = make_clean_names("Name of approved ACNC group")))
select(ACNC_groupdata,
any_of(colnames(ACNC_Datasets_13to18[[year]]),
make_clean_names("Name of approved ACNC group")))
select(ACNC_groupdata,
any_of(c(colnames(ACNC_Datasets_13to18[[year]]),
"charity_name" = make_clean_names("Name of approved ACNC group"))))
rm(list-ls())
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
View(ACNC_CombinedDataset)
filter(ACNC_CombinedDataset,
str_detect(abn, "91111")) %>% View
rm(list=ls())()
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
replace_na(ACNC_groupdata$abn,
"911111111xx")
ACNC_groupdata
sort(colnames(ACNC_groupdata))
c(1:3, NA, 2:6)
is.na(c(1:3, NA, 2:6))
unique(is.na(c(1:3, NA, 2:6)))
if(unique(is.na(c(1:3, NA, 2:6))))
if(unique(is.na(c(1:3, NA, 2:6)))){
print("success")
}
sum(is.na(c(1:3, NA, 2:6)))
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
filter(ACNC_CombinedDataset,
str_detect(abn, "91111")) %>% View
filter(ACNC_Datasets_13to18$datadotgov_ais13.xlsx,
str_detect(abn, "91111")) %>% View
filter(ACNC_Datasets_13to18$datadotgov_ais14.xlsx,
str_detect(abn, "91111")) %>% View
filter(ACNC_Datasets_13to18$datadotgov_ais15.xlsx,
str_detect(abn, "91111")) %>% View
filter(ACNC_Datasets_13to18$datadotgov_ais16.xlsx,
str_detect(abn, "91111")) %>% View
filter(ACNC_Datasets_13to18$datadotgov_ais17.xlsx,
str_detect(abn, "91111")) %>% View
filter(ACNC_Datasets_13to18$datadotgov_ais18.xlsx,
str_detect(abn, "91111")) %>% View
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
VCOSSACNC_missingcols
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
nrow(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
ACNC_Datasets_14to18
nrow(ACNC_Datasets_14to18$datadotgov_ais16)
nrow(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
nrow(VCOSS_ACNC_Datasets_14to18$datadotgov_ais15)
nrow(VCOSS_ACNC_Datasets_14to18$datadotgov_ais14)
lapply(ACNC_Datasets_14to18,
function(data){
select(data,
any_of(VCOSS_ACNC_2016_columns),
contains("government_grants"),
government_grants = contains("revenue_from_government"))
})
VCOSS_ACNC_Datasets_14to18
VCOSS_ACNC_Datasets_14to18 <- lapply(ACNC_Datasets_14to18,
function(data){
select(data,
any_of(VCOSS_ACNC_2016_columns),
contains("government_grants"),
government_grants = contains("revenue_from_government"))
})
lapply(VCOSS_ACNC_Datasets_14to18,
function(data) {
missing_cols <- VCOSS_ACNC_2016_columns[which(!(VCOSS_ACNC_2016_columns %in% colnames(data)))]
return(missing_cols)
})
Income_cols <- c("government_grants",
"donations_and_bequests",
"all_other_revenue",
"other_income") ## hard coded from VCOSS_ACNC_2016_columns
Inaccurate_income <- function(data) {
data <- mutate(data,
reported_income = sum(c_across(all_of(Income_cols))),
income_variance = abs(reported_income - total_gross_income),
inaccurate_income_reported = case_when(cleaned_charitysize == "S" &
income_variance > 25000 ~ "inaccurate",
cleaned_charitysize == "M" &
income_variance > 100000 ~ "inaccurate",
cleaned_charitysize == "L" &
income_variance > 1000000 ~ "inaccurate"))
data$inaccurate_income_reported <- replace_na(data$inaccurate_income_reported,
"accurate")
return(data)
}
lapply(VCOSS_ACNC_Datasets_14to18,
Inaccurate_income)
View(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
temp <- lapply(VCOSS_ACNC_Datasets_14to18,
Inaccurate_income)
View(temp$datadotgov_ais16)
VCOSS_ACNC_Datasets_14to18
class(VCOSS_ACNC_Datasets_14to18)
VCOSS_ACNC_Datasets_14to18[1]
VCOSS_ACNC_Datasets_14to18[[1]]
Inaccurate_income <- function(data) {
data <- mutate(data,
reported_income = sum(c_across(Income_cols)),
income_variance = abs(reported_income - total_gross_income),
inaccurate_income_reported = case_when(cleaned_charitysize == "S" &
income_variance > 25000 ~ "inaccurate",
cleaned_charitysize == "M" &
income_variance > 100000 ~ "inaccurate",
cleaned_charitysize == "L" &
income_variance > 1000000 ~ "inaccurate"))
data$inaccurate_income_reported <- replace_na(data$inaccurate_income_reported,
"accurate")
return(data)
}
temp <- lapply(VCOSS_ACNC_Datasets_14to18,
Inaccurate_income)
unique(temp$datadotgov_ais16$reported_income)
Inaccurate_income <- function(data) {
data <- mutate(rowwise(data),
reported_income = sum(c_across(all_of(Income_cols))),
income_variance = abs(reported_income - total_gross_income),
inaccurate_income_reported = case_when(cleaned_charitysize == "S" &
income_variance > 25000 ~ "inaccurate",
cleaned_charitysize == "M" &
income_variance > 100000 ~ "inaccurate",
cleaned_charitysize == "L" &
income_variance > 1000000 ~ "inaccurate"))
data$inaccurate_income_reported <- replace_na(data$inaccurate_income_reported,
"accurate")
return(data)
}
lapply(VCOSS_ACNC_Datasets_14to18,
Inaccurate_income)
temp <- lapply(VCOSS_ACNC_Datasets_14to18,
Inaccurate_income)
View(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
View(temp$datadotgov_ais16)
unique(temp$datadotgov_ais16$inaccurate_income_reported)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
41412+43
nrow(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
filter(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16,
str_detect(charity_name, regex("Australian Breastfeeding",
ignore_case = TRUE))) %>% View
View(VCOSS_ACNC_Datasets_14to18$datadotgov_ais16)
View(VCOSS_ACNC_Datasets_14to18$datadotgov_ais18)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
rm(list=ls())
gc()
source('B:/Analytics/VCOSS_ACNC_Report/Data_Cleaning.R', echo=TRUE)
